{% extends 'base.html' %}
{% block title %}Registrar Inspección{% endblock %}
{% block content %}
<h2 class="mb-4">Registrar Inspección</h2>
<div class="card shadow-sm p-4">
    <form action="{{ url_for('register_inspection') }}" method="POST">

        <!-- Datos generales: lote, secuencia, tipo, fecha -->
        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <label class="form-label">Número de Lote</label>
                <input type="number" name="numero_lote" class="form-control" placeholder="12345" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Secuencia de Inspección</label>
                <input type="text" name="secuencia" class="form-control" placeholder="A, B, C…" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Tipo de Inspección</label>
                <input type="text" name="tipo_inspeccion" class="form-control" placeholder="A ó B" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Fecha</label>
                <input type="date" name="fecha" class="form-control" required>
            </div>
            <div class="col-md-4">
                <label class="form-label">Equipo</label>
                <select id="equipmentSelect" name="id_equipo" class="form-select" required>
                    <option value="">Seleccione equipo…</option>
                    <option value="1">Alveógrafo</option>
                    <option value="2">Farinógrafo</option>
                </select>
            </div>
        </div>

        <!-- Parámetros del Alveógrafo -->
        <div id="alveo-params" class="mb-4 p-3 border rounded d-none">
            <h6 class="mb-3">Parámetros – Alveógrafo</h6>
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">W</label>
                    <input type="number" step="any" name="valor_W" class="form-control" placeholder="">
                    <small class="text-muted">180 – 350</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">P</label>
                    <input type="number" step="any" name="valor_P" class="form-control" placeholder="">
                    <small class="text-muted">70 – 130</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">L</label>
                    <input type="number" step="any" name="valor_L" class="form-control" placeholder="">
                    <small class="text-muted">90 – 140</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">P/L</label>
                    <input type="number" step="any" name="valor_relacion_P_L" class="form-control" placeholder="">
                    <small class="text-muted">0.5 – 1.0</small>
                </div>
            </div>
        </div>

        <!-- Parámetros del Farinógrafo -->
        <div id="fari-params" class="mb-4 p-3 border rounded d-none">
            <h6 class="mb-3">Parámetros – Farinógrafo</h6>
            <div class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">Absorción de agua</label>
                    <input type="number" step="any" name="valor_absorcion_de_agua" class="form-control" placeholder="">
                    <small class="text-muted">55 – 65</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Tiempo de desarrollo</label>
                    <input type="number" step="any" name="valor_tiempo_de_desarrollo" class="form-control" placeholder="">
                    <small class="text-muted">1.5 – 3.0</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Estabilidad</label>
                    <input type="number" step="any" name="valor_estabilidad" class="form-control" placeholder="">
                    <small class="text-muted">5 – 10</small>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Índice de tolerancia</label>
                    <input type="number" step="any" name="valor_indice_de_tolerancia" class="form-control" placeholder="">
                    <small class="text-muted">70 – 110</small>
                </div>
            </div>
        </div>
        <div class="text-end">
            <button type="submit" class="btn btn-primary btn-lg">Confirmar</button>
        </div>
    </form>
</div>

<script>
    const eq = document.getElementById('equipmentSelect'),
        aParams = document.getElementById('alveo-params'),
        fParams = document.getElementById('fari-params');
    eq.addEventListener('change', () => {
        aParams.classList.toggle('d-none', eq.value !== '1');
        fParams.classList.toggle('d-none', eq.value !== '2');
    });
</script>
{% endblock %}